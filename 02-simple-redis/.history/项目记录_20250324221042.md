# 1. 数据库设计开发

## 1.1 项目过程
### SQL解析器
- 负责将SQL查询转换为底层数据操作指令、
- 简单来说就是解析SQL语言，翻译编排成存储引擎的接口操作

  ``之前用Go写的，纯手写的递归下降，碰到最复杂的查询是那种嵌套了6层的子查询的select语句，解析成AST，词法分析/语法分析+过滤+语法异常检查到AST的逻辑处理完成需要7毫秒左右，且有大量的临时内存小对象产生，内存消耗在40M``
  ``
  用Rust改写了这部分模块，性能提升到900微秒左右，内存消耗在12M，逻辑也完全是一比一复刻的递归下降
  ``


## 1.2 遇到的问题

### B-Tree在内存中线程安全问题

1. 不支持多个线程同时访问（可以同时读）``多个线程交替访问的情形，访问的原子性被打破``

  - Arc`<Mutex>`
  - RwLock
  - Atomic
  - MVCC
```
混合策略：
  - 底层使用无锁的BW-Tree
  - 中间层采用乐观锁并发控制
  - 顶层实现多版本时间戳排序
```

### 事务处理

1.如何保持事务的ACID特性
